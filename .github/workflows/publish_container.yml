name: JFrog

on:
  workflow_dispatch:

defaults:
  run:
    working-directory: ./docker-jfrog

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Publish Image
        uses: actions/checkout@v4
      
      - name: Set up QEMU ğŸ—ï¸
        uses: docker/setup-qemu-action@v1

      - name: Set up Docker Buildx ğŸ‹
        uses: docker/setup-buildx-action@v1

      - name: Download docker image
        run: docker pull busybox

      - name: Login to DockerHub Registry
        run: docker login -u ${{ secrets.JFROGUSER }} -p ${{ secrets.JFROGTOKEN }} ${{ secrets.JFROGSERVER }}

      - name: Tag image
        run: docker tag trialrl5xsk.jfrog.io/artifactory/dcimages-docker-remote/busybox:latest
      
      - name: Push image
        run: docker push trialrl5xsk.jfrog.io/artifactory/dcimages-docker-remote/busybox:latest